FROM node:18-alpine

WORKDIR /app

# Copier les fichiers de dépendances (package.json est à la racine)
COPY package.json ./

# Installer les dépendances
RUN npm install

# Copier le schéma Prisma
COPY prisma ./prisma

# Générer le client Prisma
RUN npx prisma generate

# Copier le code backend
COPY src/ ./src/

# Créer le dossier pour les migrations
RUN mkdir -p prisma/migrations

# Exposer le port
EXPOSE 3000

# Commande par défaut
CMD ["npm", "run", "dev"]

